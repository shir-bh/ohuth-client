{"ast":null,"code":"var _jsxFileName = \"/Users/rapyd_academy/Desktop/rapyd_academy/tokens-proj-clientSide/react-client/src/App.js\";\nimport React, { useState, useEffect } from \"react\";\nimport logo from \"./logo.svg\";\nimport \"./App.css\";\nimport * as api from \"./api\";\nimport { FaGithub } from \"react-icons/fa\";\nimport qs from \"query-string\";\n\nfunction App() {\n  const [authenticated, set_authenticated] = useState(false);\n  const [loading, set_loading] = useState(false);\n  const [user, set_user] = useState(null);\n  const [access_token, set_access_token] = useState(null);\n  const [content, set_content] = useState(\"no content yet...\");\n  useEffect(() => {\n    if (window.location.search && window.location.search.includes(\"token\")) {\n      console.log(\"search - \", window.location.search);\n      const search = qs.parse(window.location.search);\n      console.log(\"qs - \", search);\n      const profile = JSON.parse(search.profile);\n      const {\n        token\n      } = search;\n      console.log(\"profile - \", profile);\n      console.log(\"token - \", token);\n\n      if (profile && token) {\n        set_authenticated(true);\n        set_user(profile);\n        set_access_token(token);\n        window.history.replaceState({}, document.title, \"/\");\n      }\n    } else if (!access_token) {\n      const get_access = async () => {\n        const response = await api.get_access_token();\n\n        if (\"access_token\" in response && \"profile\" in response) {\n          set_access_token(response.access_token);\n          set_authenticated(true);\n          set_user(JSON.parse(response.profile));\n        } else {\n          alert(\"please login\");\n        }\n      };\n\n      get_access();\n    }\n  }, [access_token]);\n\n  const connect = provider => {\n    set_loading(true);\n    window.location.href = `http://localhost:3030/api/auth/${provider}`;\n  };\n\n  const logout = async _ => {\n    const response = await api.logout();\n\n    if (response.message === \"You are logged out\") {\n      set_authenticated(false);\n      set_user(null);\n      set_access_token(null);\n    }\n  };\n\n  const get_protected = async _ => {\n    const token = access_token;\n    const response = await api.get_protected({\n      token\n    });\n    set_content(response.payload);\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 11\n    }\n  }, \"Auth Demo\"), /*#__PURE__*/React.createElement(\"img\", {\n    src: logo,\n    className: \"logo\",\n    alt: \"logo\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 9\n    }\n  }, \"Authenticated: \", authenticated), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 9\n    }\n  }, \"Loading: \", loading), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"profile-box\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 9\n    }\n  }, user && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 17\n    }\n  }, user.name), /*#__PURE__*/React.createElement(\"img\", {\n    className: \"profile-img\",\n    src: user && user.photo,\n    alt: \"avatar\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 17\n    }\n  })))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"App\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"header\", {\n    className: \"App-header\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"top-box\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 13\n    }\n  }, \"Auth demo\"), /*#__PURE__*/React.createElement(\"img\", {\n    src: logo,\n    className: \"logo\",\n    alt: \"logo\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 11\n    }\n  }, \"Authenticated:\", /*#__PURE__*/React.createElement(\"span\", {\n    className: \"lightblue-text\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 13\n    }\n  }, \" \" + authenticated)), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 11\n    }\n  }, \"Loading:\", /*#__PURE__*/React.createElement(\"span\", {\n    className: \"lightblue-text\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 21\n    }\n  }, \" \" + loading)), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"profile-box\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 11\n    }\n  }, user && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 17\n    }\n  }, user.name), /*#__PURE__*/React.createElement(\"img\", {\n    className: \"profile-img\",\n    src: user && user.photo,\n    alt: \"avatar\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 17\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"buttons-box\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 11\n    }\n  }, authenticated ? /*#__PURE__*/React.createElement(\"button\", {\n    className: \"btn\",\n    onClick: logout,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 15\n    }\n  }, \"Logout\") : /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    className: \"oauth-btn\",\n    onClick: () => connect(\"github\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(FaGithub, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 19\n    }\n  }))), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"btn\",\n    onClick: get_protected,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 13\n    }\n  }, \"get protected content\")), /*#__PURE__*/React.createElement(\"p\", {\n    className: \"content\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 11\n    }\n  }, content))));\n}\n\nexport default App; //:<button className=\"btn\" onClick={login}>Login</button>}","map":{"version":3,"sources":["/Users/rapyd_academy/Desktop/rapyd_academy/tokens-proj-clientSide/react-client/src/App.js"],"names":["React","useState","useEffect","api","FaGithub","qs","App","authenticated","set_authenticated","loading","set_loading","user","set_user","access_token","set_access_token","content","set_content","window","location","search","includes","console","log","parse","profile","JSON","token","history","replaceState","document","title","get_access","response","get_access_token","alert","connect","provider","href","logout","_","message","get_protected","payload","logo","name","photo"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport logo from \"./logo.svg\";\nimport \"./App.css\";\nimport * as api from \"./api\";\nimport { FaGithub } from \"react-icons/fa\";\nimport qs from \"query-string\";\n\nfunction App() {\n  const [authenticated, set_authenticated] = useState(false);\n  const [loading, set_loading] = useState(false);\n  const [user, set_user] = useState(null);\n  const [access_token, set_access_token] = useState(null);\n  const [content, set_content] = useState(\"no content yet...\");\n\n  useEffect(() => {\n    if (window.location.search && window.location.search.includes(\"token\")) {\n      console.log(\"search - \", window.location.search);\n      const search = qs.parse(window.location.search);\n      console.log(\"qs - \", search);\n      const profile = JSON.parse(search.profile);\n      const { token } = search;\n      console.log(\"profile - \", profile);\n      console.log(\"token - \", token);\n      if (profile && token) {\n        set_authenticated(true);\n        set_user(profile);\n        set_access_token(token);\n        window.history.replaceState({}, document.title, \"/\");\n      }\n    } else if (!access_token) {\n      const get_access = async () => {\n        const response = await api.get_access_token();\n        if (\"access_token\" in response && \"profile\" in response) {\n          set_access_token(response.access_token);\n          set_authenticated(true);\n          set_user(JSON.parse(response.profile));\n        } else {\n          alert(\"please login\");\n        }\n      };\n      get_access();\n    }\n  }, [access_token]);\n\n  const connect = (provider) => {\n    set_loading(true);\n    window.location.href = `http://localhost:3030/api/auth/${provider}`;\n  };\n\n  const logout = async (_) => {\n    const response = await api.logout();\n    if (response.message === \"You are logged out\") {\n      set_authenticated(false);\n      set_user(null);\n      set_access_token(null);\n    }\n  };\n  const get_protected = async (_) => {\n    const token = access_token;\n    const response = await api.get_protected({ token });\n    set_content(response.payload);\n  };\n\n  return (\n    <>\n      <div>\n        <div>\n          <h1>Auth Demo</h1>\n          <img src={logo} className=\"logo\" alt=\"logo\" />\n        </div>\n        <p>Authenticated: {authenticated}</p>\n        <p>Loading: {loading}</p>\n        <div className=\"profile-box\">\n            {user && (\n              <>\n                <p>{user.name}</p>\n                <img\n                  className=\"profile-img\"\n                  src={user && user.photo}\n                  alt=\"avatar\"\n                />\n              </>\n            )}\n          </div>\n      </div>\n\n      <div className=\"App\">\n        <header className=\"App-header\">\n          <div className=\"top-box\">\n            <h1>Auth demo</h1>\n            <img src={logo} className=\"logo\" alt=\"logo\" />\n          </div>\n\n          <p>\n            Authenticated:\n            <span className=\"lightblue-text\">{\" \" + authenticated}</span>\n          </p>\n          <p>\n            Loading:<span className=\"lightblue-text\">{\" \" + loading}</span>\n          </p>\n          <div className=\"profile-box\">\n            {user && (\n              <>\n                <p>{user.name}</p>\n                <img\n                  className=\"profile-img\"\n                  src={user && user.photo}\n                  alt=\"avatar\"\n                />\n              </>\n            )}\n          </div>\n          <div className=\"buttons-box\">\n            {authenticated ? (\n              <button className=\"btn\" onClick={logout}>\n                Logout\n              </button>\n            ) : (\n              <div>\n                <button className=\"oauth-btn\" onClick={() => connect(\"github\")}>\n                  <FaGithub />\n                </button>\n              </div>\n            )}\n            <button className=\"btn\" onClick={get_protected}>\n              get protected content\n            </button>\n          </div>\n          <p className=\"content\">{content}</p>\n        </header>\n      </div>\n    </>\n  );\n}\n\nexport default App;\n\n//:<button className=\"btn\" onClick={login}>Login</button>}\n"]},"metadata":{},"sourceType":"module"}