{"ast":null,"code":"var _jsxFileName = \"/Users/rapyd_academy/Desktop/rapyd_academy/tokens-proj-clientSide/react-client/src/App.js\";\nimport React, { useState, useEffect } from \"react\";\nimport logo from \"./logo.svg\";\nimport \"./App.css\";\nimport * as api from \"./api\";\nimport { FaGithub } from \"react-icons/fa\";\nimport qs from \"query-string\";\n\nfunction App() {\n  const [authenticated, set_authenticated] = useState(false);\n  const [loading, set_loading] = useState(false);\n  const [user, set_user] = useState(null);\n  const [access_token, set_access_token] = useState(null);\n  const [content, set_content] = useState(\"no content yet...\");\n  useEffect(() => {\n    if (window.location.search && window.location.search.includes(\"token\")) {\n      console.log(\"search - \", window.location.search);\n      const search = qs.parse(window.location.search);\n      console.log(\"qs - \", search);\n      const profile = JSON.parse(search.profile);\n      const {\n        token\n      } = search;\n      console.log(\"profile - \", profile);\n      console.log(\"token - \", token);\n\n      if (profile && token) {\n        set_authenticated(true);\n        set_user(profile);\n        set_access_token(token);\n        window.history.replaceState({}, document.title, \"/\");\n      }\n    } else if (!access_token) {\n      const get_access = async () => {\n        const response = await api.get_access_token();\n\n        if (\"access_token\" in response && \"profile\" in response) {\n          set_access_token(response.access_token);\n          set_authenticated(true);\n          set_user(JSON.parse(response.profile));\n        } else {\n          alert(\"please login\");\n        }\n      };\n\n      get_access();\n    }\n  }, [access_token]);\n\n  const connect = provider => {\n    set_loading(true);\n    window.location.href = `http://localhost:3030/api/auth/${provider}`;\n  };\n\n  const logout = async _ => {\n    const response = await api.logout();\n\n    if (response.message === \"You are logged out\") {\n      set_authenticated(false);\n      set_user(null);\n      set_access_token(null);\n    }\n  };\n\n  const get_protected = async _ => {\n    const token = access_token;\n    const response = await api.get_protected({\n      token\n    });\n    set_content(response.payload);\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 3\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 5\n    }\n  }, \"Auth Demo\"), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 5\n    }\n  }, \"Authenticated: \", authenticated), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 5\n    }\n  }, \"Loading: \", loading), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 5\n    }\n  }));\n}\n\nexport default App; //:<button className=\"btn\" onClick={login}>Login</button>}","map":{"version":3,"sources":["/Users/rapyd_academy/Desktop/rapyd_academy/tokens-proj-clientSide/react-client/src/App.js"],"names":["React","useState","useEffect","api","FaGithub","qs","App","authenticated","set_authenticated","loading","set_loading","user","set_user","access_token","set_access_token","content","set_content","window","location","search","includes","console","log","parse","profile","JSON","token","history","replaceState","document","title","get_access","response","get_access_token","alert","connect","provider","href","logout","_","message","get_protected","payload"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,QAA2C,OAA3C;;AAEA,OAAO,WAAP;AACA,OAAO,KAAKC,GAAZ,MAAqB,OAArB;AACA,SAASC,QAAT,QAAyB,gBAAzB;AACA,OAAOC,EAAP,MAAe,cAAf;;AAEA,SAASC,GAAT,GAAe;AACb,QAAM,CAACC,aAAD,EAAgBC,iBAAhB,IAAqCP,QAAQ,CAAC,KAAD,CAAnD;AACA,QAAM,CAACQ,OAAD,EAAUC,WAAV,IAAyBT,QAAQ,CAAC,KAAD,CAAvC;AACA,QAAM,CAACU,IAAD,EAAOC,QAAP,IAAmBX,QAAQ,CAAC,IAAD,CAAjC;AACA,QAAM,CAACY,YAAD,EAAeC,gBAAf,IAAmCb,QAAQ,CAAC,IAAD,CAAjD;AACA,QAAM,CAACc,OAAD,EAAUC,WAAV,IAAyBf,QAAQ,CAAC,mBAAD,CAAvC;AAEAC,EAAAA,SAAS,CAAC,MAAM;AACd,QAAIe,MAAM,CAACC,QAAP,CAAgBC,MAAhB,IAA0BF,MAAM,CAACC,QAAP,CAAgBC,MAAhB,CAAuBC,QAAvB,CAAgC,OAAhC,CAA9B,EAAwE;AACtEC,MAAAA,OAAO,CAACC,GAAR,CAAY,WAAZ,EAAyBL,MAAM,CAACC,QAAP,CAAgBC,MAAzC;AACA,YAAMA,MAAM,GAAGd,EAAE,CAACkB,KAAH,CAASN,MAAM,CAACC,QAAP,CAAgBC,MAAzB,CAAf;AACAE,MAAAA,OAAO,CAACC,GAAR,CAAY,OAAZ,EAAqBH,MAArB;AACA,YAAMK,OAAO,GAAGC,IAAI,CAACF,KAAL,CAAWJ,MAAM,CAACK,OAAlB,CAAhB;AACA,YAAM;AAAEE,QAAAA;AAAF,UAAYP,MAAlB;AACAE,MAAAA,OAAO,CAACC,GAAR,CAAY,YAAZ,EAA0BE,OAA1B;AACAH,MAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ,EAAwBI,KAAxB;;AACA,UAAIF,OAAO,IAAIE,KAAf,EAAsB;AACpBlB,QAAAA,iBAAiB,CAAC,IAAD,CAAjB;AACAI,QAAAA,QAAQ,CAACY,OAAD,CAAR;AACAV,QAAAA,gBAAgB,CAACY,KAAD,CAAhB;AACAT,QAAAA,MAAM,CAACU,OAAP,CAAeC,YAAf,CAA4B,EAA5B,EAAgCC,QAAQ,CAACC,KAAzC,EAAgD,GAAhD;AACD;AACF,KAdD,MAcO,IAAI,CAACjB,YAAL,EAAmB;AACxB,YAAMkB,UAAU,GAAG,YAAY;AAC7B,cAAMC,QAAQ,GAAG,MAAM7B,GAAG,CAAC8B,gBAAJ,EAAvB;;AACA,YAAI,kBAAkBD,QAAlB,IAA8B,aAAaA,QAA/C,EAAyD;AACvDlB,UAAAA,gBAAgB,CAACkB,QAAQ,CAACnB,YAAV,CAAhB;AACAL,UAAAA,iBAAiB,CAAC,IAAD,CAAjB;AACAI,UAAAA,QAAQ,CAACa,IAAI,CAACF,KAAL,CAAWS,QAAQ,CAACR,OAApB,CAAD,CAAR;AACD,SAJD,MAIO;AACLU,UAAAA,KAAK,CAAC,cAAD,CAAL;AACD;AACF,OATD;;AAUAH,MAAAA,UAAU;AACX;AACF,GA5BQ,EA4BN,CAAClB,YAAD,CA5BM,CAAT;;AA8BA,QAAMsB,OAAO,GAAIC,QAAD,IAAc;AAC5B1B,IAAAA,WAAW,CAAC,IAAD,CAAX;AACAO,IAAAA,MAAM,CAACC,QAAP,CAAgBmB,IAAhB,GAAwB,kCAAiCD,QAAS,EAAlE;AACD,GAHD;;AAKA,QAAME,MAAM,GAAG,MAAOC,CAAP,IAAa;AAC1B,UAAMP,QAAQ,GAAG,MAAM7B,GAAG,CAACmC,MAAJ,EAAvB;;AACA,QAAIN,QAAQ,CAACQ,OAAT,KAAqB,oBAAzB,EAA+C;AAC7ChC,MAAAA,iBAAiB,CAAC,KAAD,CAAjB;AACAI,MAAAA,QAAQ,CAAC,IAAD,CAAR;AACAE,MAAAA,gBAAgB,CAAC,IAAD,CAAhB;AACD;AACF,GAPD;;AAQA,QAAM2B,aAAa,GAAG,MAAOF,CAAP,IAAa;AACjC,UAAMb,KAAK,GAAGb,YAAd;AACA,UAAMmB,QAAQ,GAAG,MAAM7B,GAAG,CAACsC,aAAJ,CAAkB;AAAEf,MAAAA;AAAF,KAAlB,CAAvB;AACAV,IAAAA,WAAW,CAACgB,QAAQ,CAACU,OAAV,CAAX;AACD,GAJD;;AAMA,sBACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBADF,eAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAAmBnC,aAAnB,CAFF,eAGE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAAaE,OAAb,CAHF,eAIE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAJF,CADA;AAUD;;AAED,eAAeH,GAAf,C,CAEA","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport logo from \"./logo.svg\";\nimport \"./App.css\";\nimport * as api from \"./api\";\nimport { FaGithub } from \"react-icons/fa\";\nimport qs from \"query-string\";\n\nfunction App() {\n  const [authenticated, set_authenticated] = useState(false);\n  const [loading, set_loading] = useState(false);\n  const [user, set_user] = useState(null);\n  const [access_token, set_access_token] = useState(null);\n  const [content, set_content] = useState(\"no content yet...\");\n\n  useEffect(() => {\n    if (window.location.search && window.location.search.includes(\"token\")) {\n      console.log(\"search - \", window.location.search);\n      const search = qs.parse(window.location.search);\n      console.log(\"qs - \", search);\n      const profile = JSON.parse(search.profile);\n      const { token } = search;\n      console.log(\"profile - \", profile);\n      console.log(\"token - \", token);\n      if (profile && token) {\n        set_authenticated(true);\n        set_user(profile);\n        set_access_token(token);\n        window.history.replaceState({}, document.title, \"/\");\n      }\n    } else if (!access_token) {\n      const get_access = async () => {\n        const response = await api.get_access_token();\n        if (\"access_token\" in response && \"profile\" in response) {\n          set_access_token(response.access_token);\n          set_authenticated(true);\n          set_user(JSON.parse(response.profile));\n        } else {\n          alert(\"please login\");\n        }\n      };\n      get_access();\n    }\n  }, [access_token]);\n\n  const connect = (provider) => {\n    set_loading(true);\n    window.location.href = `http://localhost:3030/api/auth/${provider}`;\n  };\n\n  const logout = async (_) => {\n    const response = await api.logout();\n    if (response.message === \"You are logged out\") {\n      set_authenticated(false);\n      set_user(null);\n      set_access_token(null);\n    }\n  };\n  const get_protected = async (_) => {\n    const token = access_token;\n    const response = await api.get_protected({ token });\n    set_content(response.payload);\n  };\n\n  return (\n  <div>\n    <h1>Auth Demo</h1>\n    <p>Authenticated: {authenticated}</p>\n    <p>Loading: {loading}</p>\n    <div>\n      \n    </div>\n  </div>\n  )\n}\n\nexport default App;\n\n//:<button className=\"btn\" onClick={login}>Login</button>}\n"]},"metadata":{},"sourceType":"module"}