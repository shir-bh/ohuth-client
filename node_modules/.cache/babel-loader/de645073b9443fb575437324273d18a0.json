{"ast":null,"code":"var _jsxFileName = \"/Users/rapyd_academy/Desktop/rapyd_academy/tokens-proj-clientSide/react-client/src/App.js\";\nimport React, { useState, useEffect } from \"react\";\nimport logo from \"./logo.svg\";\nimport \"./App.css\";\nimport * as api from \"./api\";\nimport { FaGithub } from \"react-icons/fa\";\nimport qs from \"query-string\";\nimport styled from \"styled-components\";\n\nfunction App() {\n  const [authenticated, set_authenticated] = useState(false);\n  const [loading, set_loading] = useState(false);\n  const [user, set_user] = useState(null);\n  const [access_token, set_access_token] = useState(null);\n  const [content, set_content] = useState(\"no content yet...\");\n  useEffect(() => {\n    if (window.location.search && window.location.search.includes(\"token\")) {\n      console.log(\"search - \", window.location.search);\n      const search = qs.parse(window.location.search);\n      console.log(\"qs - \", search);\n      const profile = JSON.parse(search.profile);\n      const {\n        token\n      } = search;\n      console.log(\"profile - \", profile);\n      console.log(\"token - \", token);\n\n      if (profile && token) {\n        set_authenticated(true);\n        set_user(profile);\n        set_access_token(token);\n        window.history.replaceState({}, document.title, \"/\");\n      }\n    } else if (!access_token) {\n      const get_access = async () => {\n        const response = await api.get_access_token();\n\n        if (\"access_token\" in response && \"profile\" in response) {\n          set_access_token(response.access_token);\n          set_authenticated(true);\n          set_user(JSON.parse(response.profile));\n        } else {\n          alert(\"please login\");\n        }\n      };\n\n      get_access();\n    }\n  }, [access_token]);\n\n  const connect = provider => {\n    set_loading(true);\n    window.location.href = `http://localhost:3030/api/auth/${provider}`;\n  };\n\n  const logout = async _ => {\n    const response = await api.logout();\n\n    if (response.message === \"You are logged out\") {\n      set_authenticated(false);\n      set_user(null);\n      set_access_token(null);\n    }\n  };\n\n  const get_protected = async _ => {\n    const token = access_token;\n    const response = await api.get_protected({\n      token\n    });\n    set_content(response.payload);\n  };\n\n  return /*#__PURE__*/React.createElement(Div, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(H1, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 7\n    }\n  }, \"Auth Demo\"), /*#__PURE__*/React.createElement(Img, {\n    src: logo,\n    alt: \"logo\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(P, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 7\n    }\n  }, \"Authenticated:\", /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 9\n    }\n  }, \" \" + authenticated)), /*#__PURE__*/React.createElement(P, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 7\n    }\n  }, \"Loading: \", /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 18\n    }\n  }, \" \" + loading)), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"profile-box\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 7\n    }\n  }, user && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(P, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 13\n    }\n  }, user.name), /*#__PURE__*/React.createElement(Img, {\n    src: user && user.photo,\n    alt: \"avatar\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 13\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(ButtonGit, {\n    onClick: () => connect(\"github\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(FaGithub, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(Button, {\n    onClick: get_protected,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 9\n    }\n  }, \"Get Protected Content\"), /*#__PURE__*/React.createElement(Button, {\n    onClick: get_protected,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 9\n    }\n  }, \"Get Protected Content\")), /*#__PURE__*/React.createElement(P, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 7\n    }\n  }, content));\n}\n\nexport default App;\nconst Div = styled.div`\n  height: 100vh;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  background-color: #282c34;\n`;\nconst Img = styled.img`\n  height: 5rem;\n`;\nconst H1 = styled.h1`\n  color: white;\n`;\nconst P = styled.p`\n  color: white;\n`;\nconst ButtonGit = styled.button`\n  height: 2rem;\n  margin: 1rem;\n  width: 2rem;\n  border-radius: 20%;\n  border: none;\n  background-color: #61dafb;\n`;\nconst Button = styled.button`\n  height: 2rem;\n  border-radius: 3%;\n  border: none;\n  width: 10rem;\n  background-color: #61dafb;\n`;","map":{"version":3,"sources":["/Users/rapyd_academy/Desktop/rapyd_academy/tokens-proj-clientSide/react-client/src/App.js"],"names":["React","useState","useEffect","api","FaGithub","qs","styled","App","authenticated","set_authenticated","loading","set_loading","user","set_user","access_token","set_access_token","content","set_content","window","location","search","includes","console","log","parse","profile","JSON","token","history","replaceState","document","title","get_access","response","get_access_token","alert","connect","provider","href","logout","_","message","get_protected","payload","logo","name","photo","Div","div","Img","img","H1","h1","P","p","ButtonGit","button","Button"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport logo from \"./logo.svg\";\nimport \"./App.css\";\nimport * as api from \"./api\";\nimport { FaGithub } from \"react-icons/fa\";\nimport qs from \"query-string\";\nimport styled from \"styled-components\";\n\nfunction App() {\n  const [authenticated, set_authenticated] = useState(false);\n  const [loading, set_loading] = useState(false);\n  const [user, set_user] = useState(null);\n  const [access_token, set_access_token] = useState(null);\n  const [content, set_content] = useState(\"no content yet...\");\n\n  useEffect(() => {\n    if (window.location.search && window.location.search.includes(\"token\")) {\n      console.log(\"search - \", window.location.search);\n      const search = qs.parse(window.location.search);\n      console.log(\"qs - \", search);\n      const profile = JSON.parse(search.profile);\n      const { token } = search;\n      console.log(\"profile - \", profile);\n      console.log(\"token - \", token);\n      if (profile && token) {\n        set_authenticated(true);\n        set_user(profile);\n        set_access_token(token);\n        window.history.replaceState({}, document.title, \"/\");\n      }\n    } else if (!access_token) {\n      const get_access = async () => {\n        const response = await api.get_access_token();\n        if (\"access_token\" in response && \"profile\" in response) {\n          set_access_token(response.access_token);\n          set_authenticated(true);\n          set_user(JSON.parse(response.profile));\n        } else {\n          alert(\"please login\");\n        }\n      };\n      get_access();\n    }\n  }, [access_token]);\n\n  const connect = (provider) => {\n    set_loading(true);\n    window.location.href = `http://localhost:3030/api/auth/${provider}`;\n  };\n\n  const logout = async (_) => {\n    const response = await api.logout();\n    if (response.message === \"You are logged out\") {\n      set_authenticated(false);\n      set_user(null);\n      set_access_token(null);\n    }\n  };\n  const get_protected = async (_) => {\n    const token = access_token;\n    const response = await api.get_protected({ token });\n    set_content(response.payload);\n  };\n\n  return (\n    <Div>\n      <H1>Auth Demo</H1>\n      <Img src={logo} alt=\"logo\" />\n\n      <P>\n        Authenticated:\n        <span>{\" \" + authenticated}</span>\n      </P>\n      <P>\n        Loading: <span>{\" \" + loading}</span>\n      </P>\n      <div className=\"profile-box\">\n        {user && (\n          <>\n            <P>{user.name}</P>\n            <Img src={user && user.photo} alt=\"avatar\" />\n          </>\n        )}\n      </div>\n      <div>\n        <ButtonGit onClick={() => connect(\"github\")}>\n          <FaGithub />\n        </ButtonGit>\n\n        <Button onClick={get_protected}>Get Protected Content</Button>\n        <Button onClick={get_protected}>Get Protected Content</Button>\n\n      </div>\n      <P>{content}</P>\n    </Div>\n  );\n}\n\nexport default App;\n\nconst Div = styled.div`\n  height: 100vh;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  background-color: #282c34;\n`;\nconst Img = styled.img`\n  height: 5rem;\n`;\nconst H1 = styled.h1`\n  color: white;\n`;\nconst P = styled.p`\n  color: white;\n`;\nconst ButtonGit = styled.button`\n  height: 2rem;\n  margin: 1rem;\n  width: 2rem;\n  border-radius: 20%;\n  border: none;\n  background-color: #61dafb;\n`;\nconst Button = styled.button`\n  height: 2rem;\n  border-radius: 3%;\n  border: none;\n  width: 10rem;\n  background-color: #61dafb;\n`;\n"]},"metadata":{},"sourceType":"module"}